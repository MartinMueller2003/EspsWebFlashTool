<!DOCTYPE html>
<html lang="en">

    <head>
        <title>ESPS Web Flasher</title>
        <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
        <link rel="stylesheet" type="text/css" href="css/style.css">
        <h1 align = "center">ESPixelStick Software Web Flasher</h1>
    </head>

    <body>
        <class="container">
            <!-- Board Configuration -->
            <div id="pg_version" class="mdiv anchor">
                <form class="form-horizontal">
                    <legend class="esps-legend">Version</legend>
                    <div class="form-group">
                        <label class="control-label col-sm-2" for="VersionSelector">Version</label>
                        <div class="col-sm-6">
                            <fieldset id="fs_version">
                                <select id="VersionSelector"></select>
                            </fieldset>
                        </div>
                    </div>
                </form>
            </div>

            <div id="pg_board" class="mdiv anchor">
                <form class="form-horizontal">
                    <legend class="esps-legend">Board</legend>
                    <div class="form-group">
                        <label class="control-label col-sm-2" for="BoardSelector">Platform</label>
                        <div class="col-sm-6">
                            <fieldset id="fs_board">
                                <select id="BoardSelector"></select>
                            </fieldset>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Basic Configuration -->
            <div id="pg_network" class="mdiv anchor">
                <form class="form-horizontal">
                    <fieldset id="network">
                        <legend class="esps-legend">Configuration</legend>
                        <div class="form-group" id="fg_hostname">
                            <label class="control-label col-sm-2" for="hostname">Hostname</label>
                            <div class="col-sm-6">
                                <input type="text" class="form-control is-valid" id="hostname" required
                                    pattern="^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\-]*[A-Za-z0-9])$" title="Hostname for this device." value="ESPixelStick">
                            </div>
                        </div>
                        <div class="form-group" id="fg_devicename">
                            <label class="control-label col-sm-2" for="devicename">Device Name</label>
                            <div class="col-sm-6">
                                <input type="text" class="form-control is-valid" id="devicename" required
                                    pattern="^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\-]*[A-Za-z0-9])$" title="Device name for this device." value="device name">
                            </div>
                        </div>
                        <fieldset id="wifi">
                            <legend class="esps-legend">WiFi Configuration</legend>
                            <div class="form-group" id="fg_ssid">
                                <label class="control-label col-sm-2" for="ssid">SSID</label>
                                <div class="col-sm-6">
                                    <input type="text" class="form-control is-valid" id="ssid" maxlength="32"
                                        title="The SSID for your access point.">
                                </div>
                            </div>
                            <div class="form-group" id="fg_password">
                                <label class="control-label col-sm-2" for="passphrase">Password</label>
                                <div class="col-sm-6">
                                    <input type="password" class="form-control is-valid" id="passphrase" maxlength="64"
                                        title="The password for your access point.">
                                </div>
                            </div>
                            <div class="form-group" id="fg_staTimeout">
                                <label class="control-label col-sm-2" for="sta_timeout">Client Timeout</label>
                                <div class="col-sm-2">
                                    <input type="number" class="form-control is-valid" id="sta_timeout" step="1" min="15"
                                        max="60" value="0"
                                        title="When connecting as a client, this is the timeout in seconds.">
                                </div>
                            </div>
                            <div class="form-group" id="fg_apssid">
                                <label class="control-label col-sm-2" for="ap_ssid">AP SSID</label>
                                <div class="col-sm-6">
                                    <input type="text" class="form-control is-valid" id="ap_ssid" maxlength="32"
                                        title="The SSID for this device in AP mode.">
                                </div>
                            </div>
                            <div class="form-group" id="fg_appassword">
                                <label class="control-label col-sm-2" for="ap_passphrase">AP Password</label>
                                <div class="col-sm-6">
                                    <input type="password" class="form-control is-valid" id="ap_passphrase" maxlength="64"
                                        title="The password for this access point.">
                                </div>
                            </div>
                            <div class="form-group" id="fg_apTimeout">
                                <label class="control-label col-sm-2" for="ap_timeout">AP Timeout</label>
                                <div class="col-sm-2">
                                    <input type="number" class="form-control is-valid" id="ap_timeout" step="1" min="15"
                                        max="240" value="0"
                                        title="When waiting for a client to connect, this is the timeout in seconds.">
                                </div>
                            </div>
                            <div class="form-group" id="fg_apChannel">
                                <label class="control-label col-sm-2" for="ap_channel">AP WiFi Channel</label>
                                <div class="col-sm-2">
                                    <input type="number" class="form-control is-valid" id="ap_channel" step="1" min="1" max="15"
                                    title="Set the WiFi channel to be used in AP mode.">
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-offset-2 col-sm-8">
                                    <div class="checkbox"><label><input type="checkbox" id="dhcp"
                                                title="Usage of DHCP with static leases is recommended."> Use DHCP</label>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group wifiDhcp" id="fg_ip">
                                <label class="control-label col-sm-2 wifiDhcp" for="ip">IP</label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control is-valid wifiDhcp" id="ip" name="ip" minlength="7"
                                        maxlength="15" required
                                        pattern='^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'
                                        value="0.0.0.0" title="Static IP Address">
                                </div>
                            </div>
                            <div class="form-group wifiDhcp" id="fg_netmask">
                                <label class="control-label col-sm-2 wifiDhcp" for="netmask">Netmask</label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control is-valid wifiDhcp" id="netmask" name="netmask"
                                        minlength="7" maxlength="15" required
                                        pattern='^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'
                                        value="0.0.0.0" title="Static Netmask">
                                </div>
                            </div>
                            <div class="form-group wifiDhcp" id="fg_gateway">
                                <label class="control-label col-sm-2" for="gateway">Gateway</label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control is-valid wifiDhcp" id="gateway" name="gateway"
                                        minlength="7" maxlength="15" required
                                        pattern='^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'
                                        value="0.0.0.0" title="Static Gateway">
                                </div>
                            </div>
                            <div class="form-group wifiDhcp" id="fg_dnsp">
                                <label class="control-label col-sm-2" for="dnsp">Primary DNS</label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control is-valid wifiDhcp" id="dnsp" name="dnsp"
                                        minlength="7" maxlength="15" required
                                        pattern='^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'
                                        value="0.0.0.0" title="Static Primary DNS">
                                </div>
                            </div>
                            <div class="form-group wifiDhcp" id="fg_dnss">
                                <label class="control-label col-sm-2" for="dnss">Secondary DNS</label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control is-valid wifiDhcp" id="dnss" name="dnss"
                                        minlength="7" maxlength="15" required
                                        pattern='^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'
                                        value="0.0.0.0" title="Static Secondary DNS">
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-offset-2 col-sm-8">
                                    <div class="checkbox"><label><input type="checkbox" id="ap_reboot"
                                                title="Enabling this will cause your device to Reboot when all connections fail.">
                                            Reboot on Fail</label></div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-offset-2 col-sm-8">
                                    <div class="checkbox"><label><input type="checkbox" id="ap_fallback"
                                                title="Enabling this will cause your device to come up as an Access Point if your configured WiFi connection fails. Not recommended for live / production devices.">
                                            AP Fallback</label></div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-offset-2 col-sm-8">
                                    <div class="checkbox"><label><input type="checkbox" id="StayInApMode"
                                                title="Enabling this will cause your device to Stay in AP mode when all connections fail.">
                                            Stay in AP Mode</label></div>
                                </div>
                            </div>
                        </fieldset>
                        <fieldset id="eth" class="">
                            <legend class="esps-legend">Ethernet Configuration (optional)</legend>
                            <div class="form-group">
                                <div class="col-sm-offset-2 col-sm-8">
                                    <div class="checkbox"><label><input type="checkbox" id="weus"
                                                title="Allow WiFI and Ethernet to be Up at the same time."> Allow
                                            WiFi</label></div>
                                </div>
                                <div class="col-sm-offset-2 col-sm-8">
                                    <div class="checkbox"><label><input type="checkbox" id="dhcp"
                                                title="Usage of DHCP with static leases is recommended."> Use DHCP</label>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group ethdhcp" id="fg_ip">
                                <label class="control-label col-sm-2 ethdhcp" for="ip">IP</label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control is-valid ethdhcp" id="ip" name="ip" minlength="7"
                                        maxlength="15" required
                                        pattern='^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'
                                        value="0.0.0.0" title="Static IP Address">
                                </div>
                            </div>
                            <div class="form-group ethdhcp" id="fg_netmask">
                                <label class="control-label col-sm-2 ethdhcp" for="netmask">Netmask</label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control is-valid ethdhcp" id="netmask" name="netmask"
                                        minlength="7" maxlength="15" required
                                        pattern='^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'
                                        value="0.0.0.0" title="Static Netmask">
                                </div>
                            </div>
                            <div class="form-group ethdhcp" id="fg_gateway">
                                <label class="control-label col-sm-2" for="gateway">Gateway</label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control is-valid ethdhcp" id="gateway" name="gateway"
                                        minlength="7" maxlength="15" required
                                        pattern='^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'
                                        value="0.0.0.0" title="Static Gateway">
                                </div>
                            </div>
                            <div class="form-group ethdhcp" id="fg_dnsp">
                                <label class="control-label col-sm-2" for="dnsp">Primary DNS</label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control is-valid ethdhcp" id="dnsp" name="dnsp"
                                        minlength="7" maxlength="15" required
                                        pattern='^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'
                                        value="0.0.0.0" title="Static Primary DNS">
                                </div>
                            </div>
                            <div class="form-group ethdhcp" id="fg_dnss">
                                <label class="control-label col-sm-2" for="dnss">Secondary DNS</label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control is-valid ethdhcp" id="dnss" name="dnss"
                                        minlength="7" maxlength="15" required
                                        pattern='^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'
                                        value="0.0.0.0" title="Static Secondary DNS">
                                </div>
                            </div>
                        </fieldset>
                    </fieldset>
                    <fieldset>
                        <div class="form-group">
                        <div class="col-sm-offset-2 col-sm-8">
                            <button id="btn_flash" type="button" class="btn btn-primary">Flash Device</button>
                            <button id="efu_create" type="button" class="btn btn-primary">Upload EFU Image</button>
                        </div>
                        <div class="form-group hidden">
                            <div class="col-sm-offset-2 col-sm-8">
                                <label class="control-label col-sm-2" for="ota_ip">OTA Device IP Address</label>
                                <input type="text" class="form-control is-valid" id="ota_ip" name="ota_ip" minlength="7"
                                    maxlength="15"
                                    pattern='^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'
                                    value="0.0.0.0" title="Device IP Address">
                                <button id="efu_ota" type="button" class="btn btn-primary">Update ESP Using OTA (not working)</button>
                        </div>
                    </fieldset>
               </form>
            </div>
        </div>

        <!-- Update Modal -->
        <div id="update" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Firmware Updating</h4>
                    </div>
                    <div class="modal-body">
                        <p>Firmware update in progress...</p>
                        <div class="bar"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Web Error Modal -->
        <div id="wserror" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Connection to ESPS lost, attempting to reconnect...</h4>
                        <div class="bar"></div>
                    </div>
                </div>
            </div>
        </div>

        <esp-web-install-button class="hidden" id="FlashButton" manifest=""></esp-web-install-button>

        <script type="text/javascript" src="js/jquery-3.7.1.js"></script>
        <script type="text/javascript" src="js/bootstrap.js"></script>
        <script type="text/javascript" src="js/jquery.cookie.js"></script>
        <script type="module"          src="https://unpkg.com/esp-web-tools@10/dist/web/install-button.js?module"></script>
        <script type="text/javascript" src="js/EspsWebFlashTool.js"></script>
    </body>
</html>
